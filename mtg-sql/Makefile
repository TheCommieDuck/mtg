#------------------------------------------------#
# Makefile Settings -----------------------------#
#------------------------------------------------#

SHELL=bash

.EXPORT_ALL_VARIABLES:

#------------------------------------------------#
# Makefile Variables ----------------------------#
#------------------------------------------------#

LC_ALL=C.UTF-8

PGDATA=$(HOME)/.cache/postgresql/pgdata

#------------------------------------------------#

DB?=mtgsql

#------------------------------------------------#
# Makefile Targets ------------------------------#
#------------------------------------------------#

all: pg-init pg-start db-init

.PHONY: all

#------------------------------------------------#

clean:

	rm -fr ${PGDATA}
	killall postgres

	@pgrep postgres

.PHONY: clean

#------------------------------------------------#

pg-init:

	initdb

.PHONY: pg-init

#------------------------------------------------#

pg-start:

	pg_ctl -D ${PGDATA} -l logfile start

.PHONY: pg-start

#------------------------------------------------#

db-init:

	createdb $(DB)

.PHONY: db-init

#------------------------------------------------#

db-url:

	@printf "%s\n" "postgresql:///$(DB)"

.PHONY: db-url

#------------------------------------------------#
# EOF -------------------------------------------#
#------------------------------------------------#